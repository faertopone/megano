{% extends 'base_templates/base.html' %}

{% block content %}
<div class="Middle Middle_top">
    <div class="Middle-top">
      <div class="wrap">
        <div class="Middle-header">
          <h1 class="Middle-title">{{ category.category_name }}</h1>
          <ul class="breadcrumbs Middle-breadcrumbs">
            <li class="breadcrumbs-item"><a href="/">{{ _('Главная') }}</a></li>
            <li class="breadcrumbs-item breadcrumbs-item_current"><span>{{ _('Каталог') }}</span></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="Section Section_column Section_columnLeft">
      <div class="wrap">
        <div class="Section-column">
          <div class="Section-columnSection">
            <header class="Section-header">
              <strong class="Section-title">{{ _('Фильтр') }}</strong>
            </header>
            <div class="Section-columnContent">
              <form method="get">
                {{ filter.cache('category_filter:' + category.pk.__str__(), 24 * 60 * 60) }}
                <div class="buttons">
                  <input class="btn btn_square btn_dark btn_narrow" type="submit" value="{{ _('Фильтр') }}">
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="Section-content">
          <div class="Sort">
            <div class="Sort-title">{{ _('Сортировать по') }}:
            </div>
            <div class="Sort-variants">
                <a class="Sort-sortBy{% if sort_params['rating']['class'] %} {{ sort_params['rating']['class'] }}{% endif %}" data-sort="{{ sort_params['rating']['sort'] }}" href="">{{ _('Популярности') }}</a>
                <a class="Sort-sortBy{% if sort_params['price']['class'] %} {{ sort_params['price']['class'] }}{% endif %}" data-sort="{{ sort_params['price']['sort'] }}" href="">{{ _('Цене') }}</a>
            </div>
          </div>

          <div class="Cards">
            {% for product in products %}
              <div class="Card">
                <a class="Card-picture" href="#">
                  <img src="{{ static('assets/img/content/home/card.jpg') }}" alt="{{ product.name }}"/>
                </a>
                <div class="Card-content">
                  <strong class="Card-title">
                    <a href="#" title="{{ product.name }}">{{ product.name|truncate(100) }}</a>
                  </strong>
                  <div class="Card-description">
                    <div class="Card-cost">
                      <!-- TODO: когда будут сделаны скидки -->
                      <!-- span class="Card-priceOld">$115.00</span -->
                      <span class="Card-price">{{ product.price }} &#8381;</span>
                    </div>
                    <div class="Card-category">{{ category.category_name }}</div>
                    <div class="Card-hover">
                      <a class="Card-btn" href="#">
                        <img src="{{ static('assets/img/icons/card/bookmark.svg') }}" alt="bookmark.svg"/>
                      </a>
                      <a class="Card-btn" href="#">
                        <img src="{{ static('assets/img/icons/card/cart.svg') }}" alt="cart.svg"/>
                      </a>
                      <a class="Card-btn" href="#">
                        <img src="{{ static('assets/img/icons/card/change.svg') }}" alt="change.svg"/>
                      </a>
                    </div>
                  </div>
                </div>
                <!-- TODO: когда будут скидки -->
                <!-- div class="Card-sale">-60%</div -->
              </div>
            {% endfor %}
          </div>

          <div class="Pagination">
            <div class="Pagination-ins">
                <a class="Pagination-element{% if page_obj.has_previous() %} Pagination-button{% endif %}"{% if page_obj.has_previous() %} href="" data-page="{{ page_obj.previous_page_number() }}"{% endif %}>
                    <img src="{{ static('assets/img/icons/prevPagination.svg') }}" alt="prevPagination.svg"/>
                </a>

                {% for page_num in range(first_page_num, last_page_num + 1) %}
                <a class="Pagination-element Pagination-page{% if page_num == page_obj.number %} Pagination-element_current{% endif %}" href="" data-page="{{ page_num }}">
                    <span class="Pagination-text">{{ page_num }}</span>
                </a>
                {% endfor %}

                <a class="Pagination-element{% if page_obj.has_next() %} Pagination-button{% endif %}"{% if page_obj.has_next() %} href="" data-page="{{ page_obj.next_page_number() }}"{% endif %}>
                    <img src="{{ static('assets/img/icons/nextPagination.svg') }}" alt="nextPagination.svg"/>
                </a>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>
{% endblock content %}